<!DOCTYPE html>
<html>
    <body>
        <p id="status">off</p>
        <button id="connect">Connect</button>
        <button id="disconnect">Disonnect</button>
        <p>
            <label for="gravity">Gravity:</label>
            <input id="gravity" type="range" min="0" max="100" />
        </p>
        <p>
            <label for="ollie">Ollie:</label>
            <input id="ollie" type="range" min="0" max="100" />
        </p>

        <script>
            let updateInterval = 0;

            const updateLoop = () => {
                const values = ['gravity', 'ollie']
                    .map(s => document.getElementById(s).value / 100)
                    .join(';');

                fetch('http://localhost:1337', {
                    method: 'post',
                    body: values
                })
                .then(response => response.text())
                .then(body => {
                    console.log(body);
                });
            };

            const setStatus = message =>
                document.getElementById('status').innerText = message;

            document.getElementById('connect').onclick = () => {
                if (updateInterval === 0) {
                    updateInterval = setInterval(updateLoop, 100);
                    setStatus('running');
                }
            };

            document.getElementById('disconnect').onclick = () => {
                if (updateInterval !== 0) {
                    clearInterval(updateInterval);
                    updateInterval = 0;
                    setStatus('off');
                }
            };
        </script>
    </body>
</html>
